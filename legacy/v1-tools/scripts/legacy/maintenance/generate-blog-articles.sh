#!/bin/bash

# Script de g√©n√©ration automatique d'articles Markdown pour un site
# Usage: ./generate-blog-articles.sh <site-name>

set -e

SITE_NAME="$1"

if [ -z "$SITE_NAME" ]; then
    echo "‚ùå Usage: $0 <site-name>"
    echo "Exemple: $0 qalyarab"
    exit 1
fi

SITE_DIR="configs/$SITE_NAME"
BLOG_DIR="$SITE_DIR/content/blog"
IMAGES_DIR="$BLOG_DIR/images"

echo "üöÄ G√©n√©ration des articles Markdown pour: $SITE_NAME"

# Cr√©er la structure des dossiers
mkdir -p "$BLOG_DIR"
mkdir -p "$IMAGES_DIR"

# Lire la configuration du site pour adapter le contenu
CONFIG_FILE="$SITE_DIR/site-config.json"

if [ ! -f "$CONFIG_FILE" ]; then
    echo "‚ùå Configuration non trouv√©e: $CONFIG_FILE"
    exit 1
fi

# Extraire des infos de la config (nom, secteur, etc.)
SITE_BRAND=$(grep -o '"name": *"[^"]*"' "$CONFIG_FILE" | cut -d'"' -f4)
SITE_DESCRIPTION=$(grep -o '"description": *"[^"]*"' "$CONFIG_FILE" | cut -d'"' -f4)

echo "üìã Site: $SITE_BRAND"
echo "üìÅ G√©n√©ration dans: $BLOG_DIR"

# üéØ G√âN√âRATION AUTOMATIQUE D'ARTICLES SELON LE SECTEUR

# D√©terminer le secteur selon le nom/description
SECTEUR="generic"
if [[ "$SITE_BRAND" == *"caligraph"* ]] || [[ "$SITE_BRAND" == *"Qalyarab"* ]]; then
    SECTEUR="calligraphie"
elif [[ "$SITE_DESCRIPTION" == *"restaurant"* ]] || [[ "$SITE_DESCRIPTION" == *"cuisine"* ]]; then
    SECTEUR="restaurant"
elif [[ "$SITE_DESCRIPTION" == *"tech"* ]] || [[ "$SITE_DESCRIPTION" == *"digital"* ]]; then
    SECTEUR="tech"
fi

echo "üéØ Secteur d√©tect√©: $SECTEUR"

# Cr√©er un index des articles pour le markdown-loader
cat > "$BLOG_DIR/../blog-index.json" << EOF
{
  "site": "$SITE_NAME",
  "generated": "$(date -Iseconds)",
  "files": []
}
EOF

# Fonction pour cr√©er un article
create_article() {
    local filename="$1"
    local title="$2"
    local excerpt="$3"
    local category="$4"
    local tags="$5"
    local content="$6"
    local image="$7"
    
    local slug="${filename%.md}"
    local date=$(date -Iseconds)
    
    cat > "$BLOG_DIR/$filename" << EOF
---
title: "$title"
slug: "$slug"
excerpt: "$excerpt"
date: "$date"
author: "$SITE_BRAND"
category: "$category"
tags: [$tags]
image: "$image"
---

# $title

$content
EOF
    
    echo "‚úÖ Article cr√©√©: $filename"
    
    # Ajouter √† l'index
    jq ".files += [\"$filename\"]" "$BLOG_DIR/../blog-index.json" > "$BLOG_DIR/../blog-index.json.tmp" && mv "$BLOG_DIR/../blog-index.json.tmp" "$BLOG_DIR/../blog-index.json"
}

# üé® G√âN√âRATION D'ARTICLES SELON LE SECTEUR

case $SECTEUR in
    "calligraphie")
        echo "üìù G√©n√©ration d'articles pour secteur: Calligraphie"
        
        create_article "histoire-calligraphie-arabe.md" \
            "L'histoire mill√©naire de la calligraphie arabe" \
            "D√©couvrez les origines fascinantes de cet art ancestral qui traverse les si√®cles, depuis les premiers manuscrits jusqu'aux cr√©ations contemporaines." \
            "Histoire" \
            '"patrimoine", "art-islamique", "manuscrits"' \
            "La calligraphie arabe poss√®de une histoire riche et complexe qui s'√©tend sur plus de quatorze si√®cles. Cet art, n√© de la n√©cessit√© de transcrire le Coran, a √©volu√© pour devenir l'une des formes d'expression artistique les plus raffin√©es du monde islamique.

## Les origines

Les premiers d√©veloppements de la calligraphie arabe remontent au VIIe si√®cle, lorsque les scribes ont commenc√© √† standardiser l'√©criture pour la copie des textes sacr√©s. Cette p√©riode a vu na√Ætre les premiers styles distinctifs qui allaient influencer des g√©n√©rations d'artistes.

## L'√©volution des styles

Au fil des si√®cles, diff√©rentes r√©gions du monde islamique ont d√©velopp√© leurs propres variations stylistiques, cr√©ant un riche patrimoine de formes et d'expressions calligraphiques.

### Les centres d'apprentissage

- **Bagdad** : Centre n√©vralgique de l'innovation calligraphique
- **Le Caire** : D√©veloppement du style Mameluk
- **Istanbul** : Raffinement de l'art ottoman
- **Cordoue** : Fusion des traditions orientales et occidentales

## L'art moderne

Aujourd'hui, la calligraphie arabe continue d'√©voluer, int√©grant des techniques contemporaines tout en pr√©servant son essence spirituelle et esth√©tique." \
            "images/histoire-calligraphie.jpg"

        create_article "techniques-calligraphie-naskh.md" \
            "Ma√Ætriser le style Naskh : guide technique complet" \
            "Explorez les techniques fondamentales du style Naskh, l'un des styles les plus importants de la calligraphie arabe, avec des conseils pratiques pour progresser." \
            "Techniques" \
            '"naskh", "techniques", "apprentissage"' \
            "Le style **Naskh** est consid√©r√© comme l'un des styles fondamentaux de la calligraphie arabe. Sa clart√© et sa lisibilit√© en font un excellent point de d√©part pour les d√©butants.

## Caract√©ristiques du Naskh

Le Naskh se distingue par :
- **Clart√©** : Chaque lettre est distinctement form√©e
- **Proportions** : Respect strict des proportions traditionnelles
- **Fluidit√©** : Mouvement naturel de la plume

## Les outils essentiels

### Le Qalam (roseau)
Le choix du qalam est crucial. Pour le Naskh, privil√©giez :
- Largeur de 2-3mm pour d√©buter
- Coupe droite et nette
- Roseau de qualit√© (bambou ou roseau naturel)

### L'encre traditionnelle
Pr√©parez votre encre selon la recette traditionnelle :
1. M√©langez la poudre d'encre avec de l'eau pure
2. Ajoutez une goutte de miel pour la fluidit√©
3. Laissez reposer 24 heures

## Exercices progressifs

### Semaine 1-2 : Les formes de base
- Lignes droites et courbes
- Points et cercles
- Rythme et r√©gularit√©

### Semaine 3-4 : Les lettres isol√©es
- Alif, ba, ta, tha
- Concentration sur les proportions
- 100 r√©p√©titions par lettre

### Semaine 5-8 : Les liaisons
- Connexions entre lettres
- Mots simples
- Espacement r√©gulier

## Conseils pour progresser

> *La patience et la pers√©v√©rance sont les cl√©s de la ma√Ætrise calligraphique*

1. **Pratique quotidienne** : 30 minutes minimum
2. **Observation** : √âtudiez les ma√Ætres
3. **Correction** : Analysez vos erreurs
4. **Patience** : Les r√©sultats viennent avec le temps" \
            "images/technique-naskh.jpg"

        create_article "debuter-calligraphie-conseils.md" \
            "Guide du d√©butant : premiers pas en calligraphie arabe" \
            "Tous les conseils essentiels pour commencer l'apprentissage de la calligraphie arabe : mat√©riel, m√©thodes et exercices pour bien d√©buter." \
            "Conseils" \
            '"d√©butant", "mat√©riel", "apprentissage"' \
            "Commencer l'apprentissage de la calligraphie arabe peut sembler intimidant, mais avec les bons conseils et une approche m√©thodique, chacun peut progresser √† son rythme.

## Choisir son mat√©riel

### Investissement de d√©part (50-80‚Ç¨)
- **Qalam** : 3-4 roseaux de diff√©rentes tailles
- **Encre** : Encre traditionnelle de qualit√©
- **Papier** : Papier lign√© sp√©cial calligraphie
- **R√®gle** : Pour tracer les lignes de guidage

### Mat√©riel compl√©mentaire
- Porte-qalam en bois
- Buvard traditionnel
- Loupe pour les d√©tails fins

## √âtablir une routine d'apprentissage

### Planning hebdomadaire sugg√©r√©
- **Lundi/Mercredi/Vendredi** : 45 minutes de pratique technique
- **Mardi/Jeudi** : 30 minutes d'√©tude th√©orique
- **Weekend** : 1 heure de cr√©ation libre

### Structure d'une s√©ance
1. **√âchauffement** (5 min) : Lignes et courbes
2. **Technique** (25 min) : Lettres et mots
3. **Cr√©ativit√©** (10 min) : Composition libre
4. **Analyse** (5 min) : Correction des erreurs

## Les erreurs courantes √† √©viter

### Erreurs techniques
- Tenir le qalam trop serr√©
- N√©gliger l'angle de coupe
- Aller trop vite au d√©but
- Ignorer les proportions

### Erreurs d'apprentissage
- Br√ªler les √©tapes
- Manquer de r√©gularit√©
- Se d√©courager face aux difficult√©s
- N√©gliger la th√©orie

## Trouver l'inspiration

### Sources traditionnelles
- Manuscrits anciens
- ≈íuvres des ma√Ætres classiques
- Architecture islamique

### Sources contemporaines
- Calligraphes modernes sur Instagram
- Expositions d'art islamique
- Communaut√©s en ligne

## Progression attendue

### Mois 1-2 : **Fondations**
- Ma√Ætrise des outils
- Premi√®res lettres
- D√©veloppement de la patience

### Mois 3-6 : **Consolidation**
- Alphabet complet
- Premiers mots
- Compr√©hension des r√®gles

### Mois 6-12 : **Expression**
- Phrases courtes
- Style personnel
- Compositions simples

*Rappelez-vous : chaque ma√Ætre calligraphe a commenc√© par une premi√®re ligne imparfaite.*" \
            "images/guide-debutant.jpg"

        create_article "exposition-calligraphie-2024.md" \
            "Exposition 'Lettres d'Orient' : Un voyage artistique" \
            "D√©couvrez notre nouvelle exposition qui met √† l'honneur les ≈ìuvres exceptionnelles de nos √©l√®ves et des ma√Ætres contemporains." \
            "Actualit√©s" \
            '"exposition", "√©v√©nement", "art"' \
            "Nous sommes fiers de vous pr√©senter notre exposition annuelle **'Lettres d'Orient'**, un √©v√©nement qui c√©l√®bre la richesse et la diversit√© de la calligraphie arabe contemporaine.

## L'exposition en d√©tails

### Dates et horaires
- **Vernissage** : Vendredi 15 mars 2024, 18h00
- **Exposition** : Du 16 mars au 30 avril 2024
- **Horaires** : Mardi au dimanche, 10h00-18h00
- **Entr√©e libre**

### Lieu
Centre Culturel $SITE_BRAND
15 rue des Arts, Paris 11e
M√©tro : R√©publique (lignes 3, 5, 8, 9, 11)

## Les ≈ìuvres pr√©sent√©es

### Section 1 : Tradition
≈íuvres r√©alis√©es dans les styles classiques :
- **Calligraphies Naskh** : Clart√© et √©l√©gance
- **Compositions Thuluth** : Majest√© et grandeur
- **Miniatures Diwani** : Finesse ottomane

### Section 2 : Innovation
Cr√©ations contemporaines qui r√©inventent l'art :
- **Calligraphie digitale** : Fusion tradition-technologie
- **Installations 3D** : Lettres dans l'espace
- **Art urbain** : Calligraphie de rue

### Section 3 : Apprentissage
Parcours p√©dagogique pour comprendre :
- **√âvolution des styles** : Chronologie illustr√©e
- **Techniques d'√©criture** : D√©monstrations interactives
- **Outils traditionnels** : Collection historique

## √âv√©nements sp√©ciaux

### Ateliers d√©couverte (gratuits)
- **Samedi 23 mars** : Initiation Naskh (14h-16h)
- **Dimanche 31 mars** : Cr√©ation de marque-pages (10h-12h)
- **Samedi 6 avril** : Calligraphie pour enfants (14h-15h30)

### Conf√©rences
- **Mercredi 20 mars** : 'L'art calligraphique √† travers les si√®cles'
- **Mercredi 3 avril** : 'Calligraphie et spiritualit√©'

### Performances live
- **Vendredi 29 mars** : D√©monstration de calligraphie g√©ante
- **Samedi 13 avril** : Rencontre avec les artistes

## Les artistes participants

Cette exposition r√©unit :
- **12 √©l√®ves** de nos diff√©rents niveaux
- **5 instructeurs** de notre institut
- **3 ma√Ætres invit√©s** reconnus internationalement

### Invit√© d'honneur : Ma√Ætre Hassan Al-Karkhi
Calligraphe iraquien de renomm√©e mondiale, sp√©cialiste du style Diwani. Il sera pr√©sent lors du vernissage pour une d√©monstration exceptionnelle.

## Informations pratiques

### R√©servations ateliers
- **T√©l√©phone** : 01 42 36 78 90
- **Email** : expo@qalyarab.fr
- **Places limit√©es** : Inscription obligatoire

### Catalogue de l'exposition
Un magnifique catalogue de 80 pages est disponible :
- **Prix** : 25‚Ç¨
- **Contenu** : Toutes les ≈ìuvres + interviews des artistes
- **Format** : 21x24cm, reliure cousue

### Accessibilit√©
L'exposition est enti√®rement accessible aux personnes √† mobilit√© r√©duite.

---

*Cette exposition est organis√©e avec le soutien de la Mairie de Paris et l'Institut du Monde Arabe.*" \
            "images/exposition-2024.jpg"

        create_article "atelier-ramadan-2024.md" \
            "Atelier sp√©cial Ramadan : Calligraphie des versets sacr√©s" \
            "Rejoignez-nous pour un moment de recueillement et d'apprentissage autour de la calligraphie des versets coraniques pendant le mois b√©ni du Ramadan." \
            "Actualit√©s" \
            '"ramadan", "spiritualit√©", "atelier"' \
            "Durant le mois b√©ni du **Ramadan**, l'art de la calligraphie arabe prend une dimension particuli√®rement spirituelle. Notre atelier sp√©cial vous invite √† explorer la beaut√© des versets coraniques √† travers l'art calligraphique.

## Programme de l'atelier

### Session 1 : Pr√©paration spirituelle (1h)
- **M√©ditation** sur la signification des versets
- **Choix des passages** √† calligraphier ensemble
- **Pr√©paration rituelle** des outils traditionnels
- **R√©citation** pour s'impr√©gner du rythme

### Session 2 : Techniques adapt√©es (1h30)
- **Style Naskh spirituel** : Techniques sp√©cifiques aux textes sacr√©s
- **Trac√© m√©ditatif** : Chaque lettre comme une pri√®re
- **Proportions sacr√©es** : G√©om√©trie divine du texte
- **Respiration et calligraphie** : Harmoniser souffle et geste

### Session 3 : R√©alisation collective (1h30)
- **Calligraphie guid√©e** des versets choisis
- **Ornementation islamique** : Motifs g√©om√©triques simples
- **Finalisation** sur papier traditionnel dor√©
- **Partage** des cr√©ations et ressenti

## Versets s√©lectionn√©s

Nous travaillerons notamment sur ces passages :

### Verset de la Lumi√®re (An-Nur 24:35)
> *ÿßŸÑŸÑŸéŸëŸáŸè ŸÜŸèŸàÿ±Ÿè ÿßŸÑÿ≥ŸéŸëŸÖŸéÿßŸàŸéÿßÿ™Ÿê ŸàŸéÿßŸÑŸíÿ£Ÿéÿ±Ÿíÿ∂Ÿê*
> 
> *\"Allah est la lumi√®re des cieux et de la terre\"*

### Verset du Tr√¥ne (Al-Baqarah 2:255)
> *ÿßŸÑŸÑŸéŸëŸáŸè ŸÑŸéÿß ÿ•ŸêŸÑŸéŸ∞ŸáŸé ÿ•ŸêŸÑŸéŸëÿß ŸáŸèŸàŸé ÿßŸÑŸíÿ≠ŸéŸäŸèŸë ÿßŸÑŸíŸÇŸéŸäŸèŸëŸàŸÖŸè*
> 
> *\"Allah - point de divinit√© √† part Lui, le Vivant, Celui qui subsiste par lui-m√™me\"*

### Sourate Al-Fatiha (compl√®te)
La sourate d'ouverture, calligraphi√©e dans sa beaut√© int√©grale.

## Informations pratiques

### Dates et horaires
- **Tous les vendredis** du Ramadan 2024
- **Horaire** : 14h00 - 17h00 (apr√®s la pri√®re du Joumou'a)
- **Dur√©e** : 3 heures avec pause th√©/dattes

### Lieu
Salle de calligraphie $SITE_BRAND
Ambiance feutr√©e et recueillie

### Mat√©riel fourni
- **Qalam** en roseau traditionnel
- **Encre noire** de qualit√© sup√©rieure
- **Papier dor√©** sp√©cial manuscrits
- **Mod√®les** des versets en grand format

### Participation
- **Places limit√©es** √† 15 participants
- **Inscription obligatoire** avant chaque session
- **Contribution libre** selon vos moyens
- **Ouvert √† tous** les niveaux, d√©butants bienvenus

### Esprit de l'atelier
Cet atelier se d√©roule dans un esprit de **respect** et de **contemplation**. Nous accueillons participants musulmans et non-musulmans d√©sireux de d√©couvrir cette dimension spirituelle de l'art calligraphique.

## Pr√©paration recommand√©e

### Avant l'atelier
- **Tenue** : V√™tements confortables et discrets
- **√âtat d'esprit** : Venir avec s√©r√©nit√© et ouverture
- **Je√ªne** : Les participants je√ªnant sont les bienvenus

### Ce que vous repartirez avec
- **Votre cr√©ation** calligraphi√©e et ornement√©e
- **Techniques sp√©ciales** pour les textes sacr√©s
- **Moment de paix** et de connexion spirituelle
- **Liens** avec d'autres passionn√©s

## T√©moignages des ann√©es pr√©c√©dentes

*\"Cette exp√©rience a transform√© ma vision de la calligraphie. Chaque trait devient une m√©ditation.\"* - Fatima, participante 2023

*\"M√™me non-musulman, j'ai √©t√© touch√© par la beaut√© spirituelle de ces moments.\"* - Pierre, participant 2023

---

**Inscription** : 01 42 36 78 90 ou contact@qalyarab.fr

*Ramadan Kareem √† tous* üåô" \
            "images/atelier-ramadan.jpg"
        ;;
        
    "restaurant")
        echo "üìù G√©n√©ration d'articles pour secteur: Restaurant"
        
        create_article "histoire-cuisine-traditionnelle.md" \
            "L'histoire de notre cuisine traditionnelle" \
            "D√©couvrez les origines et l'√©volution de nos recettes familiales transmises de g√©n√©ration en g√©n√©ration." \
            "Histoire" \
            '"tradition", "histoire", "famille"' \
            "Notre restaurant perp√©tue une tradition culinaire familiale qui remonte √† plus d'un si√®cle..."
        
        create_article "secrets-chef.md" \
            "Les secrets de notre chef : techniques et astuces" \
            "Plongez dans les coulisses de notre cuisine et d√©couvrez les techniques qui font la diff√©rence." \
            "Techniques" \
            '"cuisine", "chef", "techniques"' \
            "Apr√®s 20 ans d'exp√©rience, notre chef partage avec vous ses secrets les mieux gard√©s..."
        ;;
        
    "tech")
        echo "üìù G√©n√©ration d'articles pour secteur: Technologie"
        
        create_article "tendances-tech-2024.md" \
            "Les tendances technologiques qui transforment 2024" \
            "Analyse des innovations qui red√©finissent notre approche du digital et de la technologie." \
            "Actualit√©s" \
            '"tech", "innovation", "2024"' \
            "L'ann√©e 2024 marque un tournant dans l'√©volution technologique avec des avanc√©es majeures..."
        ;;
        
    *)
        echo "üìù G√©n√©ration d'articles g√©n√©riques"
        
        create_article "notre-histoire.md" \
            "Notre histoire : les d√©buts de $SITE_BRAND" \
            "D√©couvrez comment $SITE_BRAND a vu le jour et √©volu√© pour devenir ce qu'il est aujourd'hui." \
            "Histoire" \
            '"histoire", "entreprise", "d√©buts"' \
            "L'histoire de $SITE_BRAND commence il y a plusieurs ann√©es, avec une vision claire et une passion authentique..."
        
        create_article "nos-valeurs.md" \
            "Nos valeurs et notre engagement" \
            "Les principes fondamentaux qui guident $SITE_BRAND au quotidien et notre engagement envers nos clients." \
            "√Ä propos" \
            '"valeurs", "engagement", "qualit√©"' \
            "Chez $SITE_BRAND, nous croyons fermement que la qualit√© et l'authenticit√© sont les piliers de toute relation durable..."
        ;;
esac

# Cr√©er quelques images placeholder
echo "üñºÔ∏è G√©n√©ration des images placeholder..."

# Cr√©er des images placeholder SVG pour √©viter les erreurs 404
for image in "histoire-calligraphie.jpg" "technique-naskh.jpg" "guide-debutant.jpg" "exposition-2024.jpg" "atelier-ramadan.jpg"; do
    if [ ! -f "$IMAGES_DIR/$image" ]; then
        cat > "$IMAGES_DIR/${image%.jpg}.svg" << EOF
<svg xmlns="http://www.w3.org/2000/svg" width="800" height="400" viewBox="0 0 800 400">
  <rect width="800" height="400" fill="#f8fafc"/>
  <text x="400" y="200" text-anchor="middle" dominant-baseline="middle" 
        font-family="Arial, sans-serif" font-size="24" fill="#64748b">
    Image: ${image%.jpg}
  </text>
  <text x="400" y="230" text-anchor="middle" dominant-baseline="middle" 
        font-family="Arial, sans-serif" font-size="16" fill="#94a3b8">
    $SITE_BRAND
  </text>
</svg>
EOF
        echo "  üì∏ Image placeholder: $image"
    fi
done

echo ""
echo "üéâ G√©n√©ration termin√©e !"
echo "üìä R√©sum√©:"
echo "  ‚Ä¢ Site: $SITE_NAME ($SECTEUR)"
echo "  ‚Ä¢ Articles cr√©√©s: $(jq '.files | length' "$BLOG_DIR/../blog-index.json")"
echo "  ‚Ä¢ Dossier: $BLOG_DIR"
echo "  ‚Ä¢ Index: $BLOG_DIR/../blog-index.json"
echo ""
echo "‚úÖ Le blog est pr√™t √† √™tre int√©gr√© au site !"